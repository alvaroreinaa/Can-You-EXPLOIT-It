// URL to search exploits and update Searchsploit
URL_SEARCH = window.location.origin + '/search';

// Wait until the DOM Content is loaded
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('search').addEventListener("click", () => {       
        searchExploits();
    });

    document.getElementById('icon').addEventListener("click", () => {       
        showIndex();
    });
});

// Search exploits in database
function searchExploits() {
    // Fixed problem with select default value
    if (document.getElementById("exploitType").value === "Exploit Type") {
        document.getElementById("exploitType").value = "";
    }

    fetch(URL_SEARCH, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            targetSoftware: document.getElementById("targetSoftware").value,
            affectedVersion: document.getElementById("affectedVersion").value,
            exploitType: document.getElementById("exploitType").value,
            exploitPlatform: document.getElementById("exploitPlatform").value,
            exploitPort: document.getElementById("exploitPort").value,
            exploitAuthor: document.getElementById("exploitAuthor").value 
        })
    });
}

// Show the index 
function showIndex() {
    window.location = window.location.origin;
}
